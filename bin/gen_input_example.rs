use pico_vm::{
    compiler::riscv::program::Program, configs::stark_config::KoalaBearPoseidon2,
    emulator::stdin::EmulatorStdin,
};
use std::fs;

type SC = KoalaBearPoseidon2;

fn main() {
    // generate and dump a boolean input
    generate_bool_input();

    // generate and dump an unsigned integer input
    generate_u32_input();

    // generate and dump a string input
    generate_string_input();

    // generate and dump a bytes input
    generate_bytes_input();
}

fn generate_bool_input() {
    // initialize a stdin builder
    let mut stdin_builder = EmulatorStdin::<Program, Vec<u8>>::new_builder::<SC>();

    // save a boolean to stdin
    let arg = false;
    stdin_builder.write(&arg);

    // serialize and dump the serialized stdin builder
    let input = bincode::serialize(&stdin_builder).unwrap();
    fs::write("bool_input.bin", &input).unwrap();

    println!("Generated bool input: 0x{}", hex::encode(input));
}

fn generate_u32_input() {
    // initialize a stdin builder
    let mut stdin_builder = EmulatorStdin::<Program, Vec<u8>>::new_builder::<SC>();

    // save an unsigned integer to stdin
    let arg = 100_u32;
    stdin_builder.write(&arg);

    // serialize and dump the serialized stdin builder
    let input = bincode::serialize(&stdin_builder).unwrap();
    fs::write("u32_input.bin", &input).unwrap();

    println!("Generated u32 input: 0x{}", hex::encode(input));
}

fn generate_string_input() {
    // initialize a stdin builder
    let mut stdin_builder = EmulatorStdin::<Program, Vec<u8>>::new_builder::<SC>();

    // save a string to stdin
    let arg = "dummy string";
    stdin_builder.write(&arg);

    // serialize and dump the serialized stdin builder
    let input = bincode::serialize(&stdin_builder).unwrap();
    fs::write("str_input.bin", &input).unwrap();

    println!("Generated string input: 0x{}", hex::encode(input));
}

fn generate_bytes_input() {
    // initialize a stdin builder
    let mut stdin_builder = EmulatorStdin::<Program, Vec<u8>>::new_builder::<SC>();

    // save bytes to stdin
    let arg = vec![1, 2, 3, 4];
    stdin_builder.write(&arg);

    // serialize and dump the serialized stdin builder
    let input = bincode::serialize(&stdin_builder).unwrap();
    fs::write("bytes_input.bin", &input).unwrap();

    println!("Generated bytes input: 0x{}", hex::encode(input));
}
